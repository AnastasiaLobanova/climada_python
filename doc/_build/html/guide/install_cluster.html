
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Installation on a server / the Euler Cluster (ETH internal) &#8212; climada 1.2.4-dev documentation</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../index.html"><h1 style="font-size: 3em;">climada</h1></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Installation on a server / the Euler Cluster (ETH internal)</a><ul>
<li><a class="reference internal" href="#download">Download</a></li>
<li><a class="reference internal" href="#unix-operating-system">Unix Operating System</a><ul>
<li><a class="reference internal" href="#install-environment-with-miniconda">Install environment with Miniconda</a></li>
<li><a class="reference internal" href="#update-climada-s-environment">Update climada’s environment</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/guide/install_cluster.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="installation-on-a-server-the-euler-cluster-eth-internal">
<span id="installation-euler"></span><h1>Installation on a server / the Euler Cluster (ETH internal)<a class="headerlink" href="#installation-on-a-server-the-euler-cluster-eth-internal" title="Permalink to this headline">¶</a></h1>
<p>Please execute the instructions of the following text boxes in a Terminal.
For ETH WCR group members, there are two directories that can be used for the installation:</p>
<ol class="arabic simple">
<li>“Home”: /cluster/home/USERNAME/</li>
<li>“Work”: /cluster/work/climate/USERNAME</li>
</ol>
<p>The advantage of using “Home” is that it is the location with the fastest access for the use of python and CLIMADA.
The disadvantage of “Home” is the limited quota of 20 GB and 100‘000 files, since both miniconda and CLIMADA come with many single files.
If you don’t have many other files stored in “Home”, (1) is the recommended option. Otherwise go for (2).</p>
<p>For all steps listed below, first enter the Cluster via SSH.</p>
<p>On the server, go to either your “Home” or your “Work” environment. In the following we will go for option (2) and install everything in the “Work” path.
If you are using a different server or option, please customise the paths in each step:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">cluster</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">climate</span><span class="o">/</span><span class="n">USERNAME</span>
</pre></div>
</div>
<div class="section" id="download">
<h2>Download<a class="headerlink" href="#download" title="Permalink to this headline">¶</a></h2>
<p><strong>Version in development</strong>: Download or clone the GitHub repository <a class="reference external" href="https://github.com/CLIMADA-project/climada_python.git">climada_python</a>.</p>
<p>To clone the repository, you need to first <a class="reference external" href="https://www.linode.com/docs/development/version-control/how-to-install-git-on-linux-mac-and-windows/">install git</a>.
Afterwards you can use the following command line with climada_python’s URL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">CLIMADA</span><span class="o">-</span><span class="n">project</span><span class="o">/</span><span class="n">climada_python</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</div>
<div class="section" id="unix-operating-system">
<h2>Unix Operating System<a class="headerlink" href="#unix-operating-system" title="Permalink to this headline">¶</a></h2>
<div class="section" id="install-environment-with-miniconda">
<h3>Install environment with Miniconda<a class="headerlink" href="#install-environment-with-miniconda" title="Permalink to this headline">¶</a></h3>
<p>1. <strong>Miniconda</strong>: Download or update to the latest version of <a class="reference external" href="https://conda.io/miniconda.html">Miniconda</a>. You can do so by following these steps
(using wget to download miniconda installation file: <a class="reference external" href="https://conda.io/en/latest/miniconda.html">https://conda.io/en/latest/miniconda.html</a>, Python 3.7, LINUX, 64bit):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">cd</span> <span class="o">/</span><span class="n">cluster</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">climate</span><span class="o">/</span><span class="n">USERNAME</span>
 <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">repo</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">miniconda</span><span class="o">/</span><span class="n">Miniconda3</span><span class="o">-</span><span class="n">latest</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
 <span class="n">bash</span> <span class="n">Miniconda3</span><span class="o">-</span><span class="n">latest</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
 <span class="n">rm</span> <span class="n">Miniconda3</span><span class="o">-</span><span class="n">latest</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
 <span class="n">cd</span> <span class="n">climada_python</span>
 <span class="n">conda</span> <span class="n">env</span> <span class="n">create</span> <span class="o">-</span><span class="n">f</span> <span class="n">requirements</span><span class="o">/</span><span class="n">env_climada</span><span class="o">.</span><span class="n">yml</span> <span class="o">--</span><span class="n">name</span> <span class="n">climada_env</span>


<span class="n">During</span> <span class="n">the</span> <span class="n">installation</span> <span class="n">process</span> <span class="n">of</span> <span class="n">Miniconda</span><span class="p">,</span> <span class="n">you</span> <span class="n">are</span> <span class="n">prompted</span> <span class="n">to</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">working</span> <span class="n">directory</span> <span class="n">according</span> <span class="n">to</span> <span class="n">your</span> <span class="n">choice</span><span class="o">.</span>
</pre></div>
</div>
<ol class="arabic" start="2">
<li><p class="first"><strong>Install dependencies</strong>: Create the virtual environment <em>climada_env</em> with climada’s dependencies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">env</span> <span class="n">create</span> <span class="o">-</span><span class="n">f</span> <span class="n">requirements</span><span class="o">/</span><span class="n">env_climada</span><span class="o">.</span><span class="n">yml</span> <span class="o">--</span><span class="n">name</span> <span class="n">climada_env</span>
</pre></div>
</div>
<p>To include <em>climada_python</em> in the environment’s path, do the following. In your environments folder, for example /cluster/work/climate/USERNAME/miniconda3/<a href="#id1"><span class="problematic" id="id2">*</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">envs</span><span class="o">/</span><span class="n">climada_env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span>
<span class="n">echo</span> <span class="s1">&#39;/your/path/to/climada_python/&#39;</span> <span class="o">&gt;</span> <span class="n">climada_env_path</span><span class="o">.</span><span class="n">pth</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Test installation</strong>: Activate the environment, execute the unit tests and deactivate the environment when finished using climada:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="n">activate</span> <span class="n">climada_env</span>
<span class="n">python3</span> <span class="n">tests_runner</span><span class="o">.</span><span class="n">py</span>
<span class="n">source</span> <span class="n">deactivate</span>
</pre></div>
</div>
<p>If the installation has been successful, an OK will appear at the end of the execution.</p>
<p>Warning: Executing the whole test_runner takes pretty long and downloads some files to climada_python/data that you might not need.
Consider aborting the test once you see first “OK”s in the output.</p>
</li>
<li><p class="first"><strong>Submit a test BJOB to the queue of the cluster</strong>: Write a shell script that initiates the Python environment climada_env and submit the job:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">touch</span> <span class="n">run_climada_python</span><span class="o">.</span><span class="n">sh</span>
<span class="n">echo</span> <span class="s2">&quot;#!/bin/sh&quot;</span> <span class="o">&gt;</span> <span class="n">run_climada_python</span><span class="o">.</span><span class="n">sh</span>
<span class="n">echo</span> <span class="s2">&quot;cd /cluster/work/climate/USERNAME/climada_python&quot;</span> <span class="o">&gt;&gt;</span> <span class="n">run_climada_python</span><span class="o">.</span><span class="n">sh</span>
<span class="n">echo</span> <span class="s2">&quot;source activate climada_env&quot;</span> <span class="o">&gt;&gt;</span> <span class="n">run_climada_python</span><span class="o">.</span><span class="n">sh</span>
<span class="n">echo</span> <span class="s2">&quot;python3 script/tutorial/climada_hazard_drought.py&quot;</span> <span class="o">&gt;&gt;</span> <span class="n">run_climada_python</span><span class="o">.</span><span class="n">sh</span>
<span class="n">echo</span> <span class="s2">&quot;conda deactivate&quot;</span> <span class="o">&gt;&gt;</span> <span class="n">run_climada_python</span><span class="o">.</span><span class="n">sh</span>
<span class="n">echo</span> <span class="s2">&quot;echo script completed&quot;</span> <span class="o">&gt;&gt;</span> <span class="n">run_climada_python</span><span class="o">.</span><span class="n">sh</span>
<span class="n">chmod</span> <span class="mi">755</span> <span class="n">run_climada_python</span><span class="o">.</span><span class="n">sh</span>
<span class="n">bsub</span> <span class="o">-</span><span class="n">J</span> <span class="s2">&quot;test01&quot;</span> <span class="o">-</span><span class="n">W</span> <span class="mi">1</span><span class="p">:</span><span class="mi">00</span> <span class="o">-</span><span class="n">R</span> <span class="s2">&quot;rusage[mem=5120]&quot;</span> <span class="o">-</span><span class="n">oo</span> <span class="n">logs</span><span class="o">/</span><span class="n">test01</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">eo</span> <span class="n">logs</span><span class="o">/</span><span class="n">e_test01</span><span class="o">.</span><span class="n">txt</span> <span class="o">&lt;</span> <span class="n">run_climada_python</span><span class="o">.</span><span class="n">sh</span>
<span class="n">bjobs</span>
</pre></div>
</div>
<p>Notes:</p>
<ul class="simple">
<li>Change the script after echo “python3” to the path of the Python script you want to execute</li>
<li>Change the working path to the path you have cloned the climada_python repository to</li>
<li>Customise the bsub options accordingly</li>
<li>Check out <a class="reference external" href="https://scicomp.ethz.ch/wiki/Using_the_batch_system#Basic_job_submission">https://scicomp.ethz.ch/wiki/Using_the_batch_system#Basic_job_submission</a> for more info on job submission.</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="update-climada-s-environment">
<h3>Update climada’s environment<a class="headerlink" href="#update-climada-s-environment" title="Permalink to this headline">¶</a></h3>
<p>Before using climada’s code in development, remember to update your code as well as climada’s environment. The requirements in <code class="docutils literal notranslate"><span class="pre">requirements/env_developer.yml</span></code> contain all the packages which are necessary to execute the continuous integration of climada. These can be therefore useful for climada’s contributors.</p>
<p>If you use conda, you might use the following commands to update the environments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">climada_python</span>
<span class="n">git</span> <span class="n">pull</span>
<span class="n">source</span> <span class="n">activate</span> <span class="n">climada_env</span>
<span class="n">conda</span> <span class="n">env</span> <span class="n">update</span> <span class="o">--</span><span class="n">file</span> <span class="n">requirements</span><span class="o">/</span><span class="n">env_climada</span><span class="o">.</span><span class="n">yml</span>
<span class="n">conda</span> <span class="n">env</span> <span class="n">update</span> <span class="o">--</span><span class="n">file</span> <span class="n">requirements</span><span class="o">/</span><span class="n">env_developer</span><span class="o">.</span><span class="n">yml</span>
</pre></div>
</div>
<p>If any problem occurs during this process, consider reinstalling everything from scratch following the <a href="#id3"><span class="problematic" id="id4">`Installation`_</span></a> instructions.
You can find more information about virtual environments with conda <a class="reference external" href="https://conda.io/docs/user-guide/tasks/manage-environments.html">here</a>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, ETH Zurich.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>