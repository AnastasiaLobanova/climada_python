
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Hazard class &#8212; climada 1.2.4-dev documentation</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
  </head><body>

<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../index.html"><h1 style="font-size: 3em;">climada</h1></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Hazard class</a><ul>
<li><a class="reference internal" href="#Read-Hazards">Read Hazards</a></li>
<li><a class="reference internal" href="#Methods">Methods</a><ul>
<li><a class="reference internal" href="#EXERCISE:">EXERCISE:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#&nbsp;Visualize-Hazards">&nbsp;Visualize Hazards</a></li>
<li><a class="reference internal" href="#&nbsp;Write-a-hazard">&nbsp;Write a hazard</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tutorial/climada_hazard_Hazard.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 7ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Hazard-class">
<h1>Hazard class<a class="headerlink" href="#Hazard-class" title="Permalink to this headline">Â¶</a></h1>
<p>A Hazard contains the following information:</p>
<ul class="simple">
<li>tag (TagHazard): information about the source</li>
<li>units (str): units of the intensity</li>
<li>centroids (Centroids): centroids of the events</li>
<li>event_id (np.array): id (&gt;0) of each event</li>
<li>event_name (list(str)): name of each event (default: event_id)</li>
<li>date (np.array): integer date corresponding to the proleptic Gregorian ordinal, where January 1 of year 1 has ordinal 1 (ordinal format of datetime library)</li>
<li>frequency (np.array): frequency of each event in seconds</li>
<li>orig_event (np.array): flags indicating historical events (True) or probabilistic (False)</li>
<li>intensity (sparse.csr_matrix): intensity of the events at centroids</li>
<li>fraction (sparse.csr_matrix): fraction of affected exposures for each event at each centroid</li>
</ul>
<p>Note that <code class="docutils literal notranslate"><span class="pre">intensity</span></code> and <code class="docutils literal notranslate"><span class="pre">fraction</span></code> are scipy.sparse matrices of size num_events x num_centroids. The <code class="docutils literal notranslate"><span class="pre">Centroids</span></code> class contains the geographical coordinates where the hazard is defined. A <code class="docutils literal notranslate"><span class="pre">Centroids</span></code> instance provides each coordinate with an id and canât contain two identical coordinates.</p>
<div class="section" id="Read-Hazards">
<h2>Read Hazards<a class="headerlink" href="#Read-Hazards" title="Permalink to this headline">Â¶</a></h2>
<p>Hazards can be read from Excel files following the template in <code class="docutils literal notranslate"><span class="pre">climada_python/data/system/hazard_template.xlsx</span></code> using the <code class="docutils literal notranslate"><span class="pre">read_excel()</span></code> method. Hazards generated with CLIMADAâs MATLAB version (.mat format) can be read using <code class="docutils literal notranslate"><span class="pre">read_mat()</span></code>. Hazards generated with the CLIMADA in Python (.h5 format) can be read using <code class="docutils literal notranslate"><span class="pre">read_hdf5()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">climada.hazard</span> <span class="kn">import</span> <span class="n">Hazard</span>
<span class="kn">from</span> <span class="nn">climada.util</span> <span class="kn">import</span> <span class="n">HAZ_DEMO_H5</span> <span class="c1"># CLIMADA&#39;s Python file</span>
<span class="c1"># Hazard needs to know the acronym of the hazard type to be constructed!!! Use &#39;NA&#39; if not known.</span>
<span class="n">haz_tc_fl</span> <span class="o">=</span> <span class="n">Hazard</span><span class="p">(</span><span class="s1">&#39;TC&#39;</span><span class="p">)</span>
<span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">read_hdf5</span><span class="p">(</span><span class="n">HAZ_DEMO_H5</span><span class="p">)</span>  <span class="c1"># Historic and synthetic tropical cyclones in Florida from 1975 to 2011</span>
<span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">check</span><span class="p">()</span> <span class="c1"># Use always the check() method to see if the hazard has been loaded correctly</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-03-29 18:37:38,141 - climada - DEBUG - Loading default config file: /Users/aznarsig/Documents/Python/climada_python/climada/conf/defaults.conf
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/aznarsig/anaconda3/envs/climada_env/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
</pre></div></div>
</div>
<p>Other types of data can be ingested using Python libraries. Whilst every case might be different, in general raster data can be loaded using <code class="docutils literal notranslate"><span class="pre">gdal</span></code> library as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">sparse</span>
<span class="kn">import</span> <span class="nn">gdal</span>

<span class="kn">from</span> <span class="nn">climada.hazard</span> <span class="kn">import</span> <span class="n">Hazard</span>
<span class="kn">from</span> <span class="nn">climada.util.constants</span> <span class="kn">import</span> <span class="n">HAZ_DEMO_FL</span>

<span class="c1"># read raster data of flood in Venezuela</span>
<span class="n">MODEL_NAN</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9999</span>

<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Opening file&#39;</span><span class="p">,</span> <span class="n">HAZ_DEMO_FL</span><span class="p">)</span>
<span class="n">haz_file</span> <span class="o">=</span> <span class="n">gdal</span><span class="o">.</span><span class="n">Open</span><span class="p">(</span><span class="s1">&#39;/vsigzip/&#39;</span> <span class="o">+</span> <span class="n">HAZ_DEMO_FL</span><span class="p">)</span>

<span class="n">haz_data</span> <span class="o">=</span> <span class="n">haz_file</span><span class="o">.</span><span class="n">ReadAsArray</span><span class="p">()</span>
<span class="n">haz_data</span><span class="p">[</span><span class="n">haz_data</span> <span class="o">==</span> <span class="n">MODEL_NAN</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">haz_data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">haz_data</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.</span>

<span class="n">ulx</span><span class="p">,</span> <span class="n">xres</span><span class="p">,</span> <span class="n">xskew</span><span class="p">,</span> <span class="n">uly</span><span class="p">,</span> <span class="n">yskew</span><span class="p">,</span> <span class="n">yres</span>  <span class="o">=</span> <span class="n">haz_file</span><span class="o">.</span><span class="n">GetGeoTransform</span><span class="p">()</span>
<span class="n">lrx</span> <span class="o">=</span> <span class="n">ulx</span> <span class="o">+</span> <span class="p">(</span><span class="n">haz_file</span><span class="o">.</span><span class="n">RasterXSize</span> <span class="o">*</span> <span class="n">xres</span><span class="p">)</span>
<span class="n">lry</span> <span class="o">=</span> <span class="n">uly</span> <span class="o">+</span> <span class="p">(</span><span class="n">haz_file</span><span class="o">.</span><span class="n">RasterYSize</span> <span class="o">*</span> <span class="n">yres</span><span class="p">)</span>

<span class="n">x_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ulx</span><span class="o">+</span><span class="n">xres</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">lrx</span><span class="p">,</span> <span class="n">xres</span><span class="p">)</span>
<span class="n">y_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">uly</span><span class="o">+</span><span class="n">yres</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">lry</span><span class="p">,</span> <span class="n">yres</span><span class="p">)</span>
<span class="n">grid_x</span><span class="p">,</span> <span class="n">grid_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_points</span><span class="p">,</span> <span class="n">y_points</span><span class="p">)</span>

<span class="c1"># fill hazard</span>
<span class="n">haz</span> <span class="o">=</span> <span class="n">Hazard</span><span class="p">(</span><span class="s1">&#39;FL&#39;</span><span class="p">)</span>
<span class="n">haz</span><span class="o">.</span><span class="n">centroids</span><span class="o">.</span><span class="n">coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">grid_x</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">haz</span><span class="o">.</span><span class="n">centroids</span><span class="o">.</span><span class="n">coord</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid_y</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">haz</span><span class="o">.</span><span class="n">centroids</span><span class="o">.</span><span class="n">coord</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid_x</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="n">haz</span><span class="o">.</span><span class="n">centroids</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">haz</span><span class="o">.</span><span class="n">centroids</span><span class="o">.</span><span class="n">coord</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">haz</span><span class="o">.</span><span class="n">intensity</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">haz_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
<span class="n">haz</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s1">&#39;m&#39;</span>
<span class="n">haz</span><span class="o">.</span><span class="n">event_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
<span class="n">haz</span><span class="o">.</span><span class="n">event_name</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Venezuela&#39;</span><span class="p">)</span>
<span class="n">haz</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
<span class="n">haz</span><span class="o">.</span><span class="n">orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
<span class="n">haz</span><span class="o">.</span><span class="n">frequency</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.01</span>
<span class="n">haz</span><span class="o">.</span><span class="n">fraction</span> <span class="o">=</span> <span class="n">haz</span><span class="o">.</span><span class="n">intensity</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">haz</span><span class="o">.</span><span class="n">fraction</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">haz</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>

<span class="c1"># plot hazard</span>
<span class="n">haz</span><span class="o">.</span><span class="n">plot_intensity</span><span class="p">(</span><span class="s1">&#39;Venezuela&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Opening file /Users/aznarsig/Documents/Python/climada_python/data/demo/SC22000_VE__M1.grd.gz
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(&lt;Figure size 648x936 with 2 Axes&gt;,
 array([[&lt;cartopy.mpl.geoaxes.GeoAxesSubplot object at 0x1a1f56a940&gt;]],
       dtype=object))
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_hazard_Hazard_4_2.png" src="../_images/tutorial_climada_hazard_Hazard_4_2.png" />
</div>
</div>
</div>
<div class="section" id="Methods">
<h2>Methods<a class="headerlink" href="#Methods" title="Permalink to this headline">Â¶</a></h2>
<p>The following methods can be used to analyse the data in <code class="docutils literal notranslate"><span class="pre">Hazard</span></code>:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">calc_year_set()</span></code> method returns a dictionary with all the historical (not synthetic) event ids that happened at each year.</li>
<li><code class="docutils literal notranslate"><span class="pre">get_event_date()</span></code> returns strings of dates in ISO format.</li>
<li>To obtain the relation between event ids and event names, two methods can be used <code class="docutils literal notranslate"><span class="pre">get_event_name()</span></code> and <code class="docutils literal notranslate"><span class="pre">get_event_id()</span></code>.</li>
</ul>
<p>Other methods to handle one or several Hazards are: - the property <code class="docutils literal notranslate"><span class="pre">size</span></code> returns the number of events contained. - <code class="docutils literal notranslate"><span class="pre">append()</span></code> is used to expand the data with data from another <code class="docutils literal notranslate"><span class="pre">Hazard</span></code>. - <code class="docutils literal notranslate"><span class="pre">select()</span></code> returns a new hazard with the selected region, date and/or synthetic or historical filter. - <code class="docutils literal notranslate"><span class="pre">remove_duplicates()</span></code>: removes events with same name and date. - <code class="docutils literal notranslate"><span class="pre">local_exceedance_inten()</span></code> returns a matrix with the exceedence frequency at every frequency and provided return periods. This is
the one used in <code class="docutils literal notranslate"><span class="pre">plot_rp_intensity()</span></code>.</p>
<div class="section" id="EXERCISE:">
<h3>EXERCISE:<a class="headerlink" href="#EXERCISE:" title="Permalink to this headline">Â¶</a></h3>
<p>Using the previous hazard <code class="docutils literal notranslate"><span class="pre">haz_tc_fl</span></code> answer these questions: 1. How many synthetic events are contained? 2. Generate an hazard with historical hurricanes ocurring between 1995 and 2001. 3. How many historical hurricanes occured in 1999? Which was the year with most hurricanes between 1995 and 2001?</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Put your code here:</span>




</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># SOLUTION:</span>

<span class="c1"># 1.How many synthetic events are contained?</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Number of total events:&#39;</span><span class="p">,</span> <span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Number of synthetic events:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">orig</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="c1"># 2. Generate an hazard with historical hurricanes ocurring between 1995 and 2001.</span>
<span class="n">hist_tc</span> <span class="o">=</span> <span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">date</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;1995-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2001-12-31&#39;</span><span class="p">),</span> <span class="n">orig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Number of historical events between 1995 and 2001:&#39;</span><span class="p">,</span> <span class="n">hist_tc</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># 3. How many historical hurricanes occured in 1999? Which was the year with most hurricanes between 1995 and 2001?</span>
<span class="n">ev_per_year</span> <span class="o">=</span> <span class="n">hist_tc</span><span class="o">.</span><span class="n">calc_year_set</span><span class="p">()</span> <span class="c1"># events ids per year</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Number of events in 1999:&#39;</span><span class="p">,</span> <span class="n">ev_per_year</span><span class="p">[</span><span class="mi">1999</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">max_year</span> <span class="o">=</span> <span class="mi">1995</span>
<span class="n">max_ev</span> <span class="o">=</span> <span class="n">ev_per_year</span><span class="p">[</span><span class="mi">1995</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>
<span class="k">for</span> <span class="n">year</span><span class="p">,</span> <span class="n">ev</span> <span class="ow">in</span> <span class="n">ev_per_year</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">ev</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="n">max_ev</span><span class="p">:</span>
        <span class="n">max_year</span> <span class="o">=</span> <span class="n">year</span>
<span class="k">print</span><span class="p">(</span><span class="s1">&#39;Year with most hurricanes between 1995 and 2001:&#39;</span><span class="p">,</span> <span class="n">max_year</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of total events: 2405
Number of synthetic events: 1924
Number of historical events between 1995 and 2001: 109
Number of events in 1999: 16
Year with most hurricanes between 1995 and 2001: 1995
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="&nbsp;Visualize-Hazards">
<h2>&nbsp;Visualize Hazards<a class="headerlink" href="#Â Visualize-Hazards" title="Permalink to this headline">Â¶</a></h2>
<p>There are three different plot functions: <code class="docutils literal notranslate"><span class="pre">plot_intensity()</span></code>, <code class="docutils literal notranslate"><span class="pre">plot_fraction()</span></code>and <code class="docutils literal notranslate"><span class="pre">plot_rp_intensity()</span></code>. Depending on the inputs, different properties can be visualized. Check the documentation of the functions:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">plot_intensity</span><span class="p">)</span>
<span class="n">help</span><span class="p">(</span><span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">plot_rp_intensity</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on method plot_intensity in module climada.hazard.base:

plot_intensity(event=None, centr=None, **kwargs) method of climada.hazard.base.Hazard instance
    Plot intensity values for a selected event or centroid.

    Parameters:
        event (int or str, optional): If event &gt; 0, plot intensities of
            event with id = event. If event = 0, plot maximum intensity in
            each centroid. If event &lt; 0, plot abs(event)-largest event. If
            event is string, plot events with that name.
        centr (int or tuple, optional): If centr &gt; 0, plot intensity
            of all events at centroid with id = centr. If centr = 0,
            plot maximum intensity of each event. If centr &lt; 0,
            plot abs(centr)-largest centroid where higher intensities
            are reached. If tuple with (lat, lon) plot intensity of nearest
            centroid.
        kwargs (optional): arguments for pcolormesh matplotlib function
            used in event plots

    Returns:
        matplotlib.figure.Figure, matplotlib.axes._subplots.AxesSubplot

    Raises:
        ValueError

Help on method plot_rp_intensity in module climada.hazard.base:

plot_rp_intensity(return_periods=(25, 50, 100, 250), **kwargs) method of climada.hazard.base.Hazard instance
    Compute and plot hazard exceedance intensity maps for different
    return periods. Calls local_exceedance_inten.

    Parameters:
        return_periods (tuple(int), optional): return periods to consider
        kwargs (optional): arguments for pcolormesh matplotlib function
            used in event plots

    Returns:
        matplotlib.figure.Figure, matplotlib.axes._subplots.AxesSubplot,
        np.ndarray (return_periods.size x num_centroids)

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># 1. intensities of the largest event (defined as greater sum of intensities):</span>
<span class="c1">#Â all events:</span>
<span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">plot_intensity</span><span class="p">(</span><span class="n">event</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 1985260N13336_gen3 is a synthetic event</span>
<span class="c1"># only historical events:</span>
<span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">orig</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">plot_intensity</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># largest historical event: 1992230N11325 hurricane ANDREW</span>

<span class="c1"># 2. maximum intensities at each centroid:</span>
<span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">plot_intensity</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># 3. intensities of hurricane 2010236N12341_gen3:</span>
<span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">plot_intensity</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="s1">&#39;2010236N12341_gen3&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;BuGn&#39;</span><span class="p">)</span> <span class="c1"># setting color map</span>

<span class="c1"># 4. tropical cyclone intensities maps for the return periods [10, 50, 75, 100]</span>
<span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">plot_rp_intensity</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>

<span class="c1"># 5. intensities of all the events in centroid with id 50</span>
<span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">plot_intensity</span><span class="p">(</span><span class="n">centr</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># 5. intensities of all the events in centroid closest to lat, lon = (26.5, -81)</span>
<span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">plot_intensity</span><span class="p">(</span><span class="n">centr</span><span class="o">=</span><span class="p">(</span><span class="mf">26.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">81</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-03-29 18:38:11,869 - climada.hazard.base - INFO - Computing exceedance intenstiy map for return periods: [ 10  50  75 100]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_hazard_Hazard_10_1.png" src="../_images/tutorial_climada_hazard_Hazard_10_1.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_hazard_Hazard_10_2.png" src="../_images/tutorial_climada_hazard_Hazard_10_2.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_hazard_Hazard_10_3.png" src="../_images/tutorial_climada_hazard_Hazard_10_3.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_hazard_Hazard_10_4.png" src="../_images/tutorial_climada_hazard_Hazard_10_4.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_hazard_Hazard_10_5.png" src="../_images/tutorial_climada_hazard_Hazard_10_5.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_hazard_Hazard_10_6.png" src="../_images/tutorial_climada_hazard_Hazard_10_6.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_climada_hazard_Hazard_10_7.png" src="../_images/tutorial_climada_hazard_Hazard_10_7.png" />
</div>
</div>
</div>
<div class="section" id="&nbsp;Write-a-hazard">
<h2>&nbsp;Write a hazard<a class="headerlink" href="#Â Write-a-hazard" title="Permalink to this headline">Â¶</a></h2>
<p>Hazards can be written and read in hdf5 format as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">haz_tc_fl</span><span class="o">.</span><span class="n">write_hdf5</span><span class="p">(</span><span class="s1">&#39;results/haz_tc_fl.h5&#39;</span><span class="p">)</span>

<span class="n">haz</span> <span class="o">=</span> <span class="n">Hazard</span><span class="p">(</span><span class="s1">&#39;TC&#39;</span><span class="p">)</span>
<span class="n">haz</span><span class="o">.</span><span class="n">read_hdf5</span><span class="p">(</span><span class="s1">&#39;results/haz_tc_fl.h5&#39;</span><span class="p">)</span>
<span class="n">haz</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Pickle will work as well:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">climada.util.save</span> <span class="kn">import</span> <span class="n">save</span>
<span class="c1"># this generates a results folder in the current path and stores the output there</span>
<span class="n">save</span><span class="p">(</span><span class="s1">&#39;tutorial_haz_tc_fl.p&#39;</span><span class="p">,</span> <span class="n">haz_tc_fl</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2019-03-29 18:38:29,583 - climada.util.save - INFO - Written file /Users/aznarsig/Documents/Python/climada_python/script/tutorial/results/tutorial_haz_tc_fl.p
</pre></div></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">home</a>|&nbsp;</li>
        <li><a href="../search.html">search</a>|&nbsp;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, ETH Zurich.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>